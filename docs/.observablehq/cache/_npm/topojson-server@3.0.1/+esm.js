/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/topojson-server@3.0.1/src/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var r=Object.prototype.hasOwnProperty;function n(r,n,t,e,o,i){3===arguments.length&&(e=i=Array,o=null);for(var a=new e(r=1<<Math.max(4,Math.ceil(Math.log(r)/Math.LN2))),u=new i(r),f=r-1,c=0;c<r;++c)a[c]=o;return{set:function(e,i){for(var c=n(e)&f,l=a[c],s=0;l!=o;){if(t(l,e))return u[c]=i;if(++s>=r)throw new Error("full hashmap");l=a[c=c+1&f]}return a[c]=e,u[c]=i,i},maybeSet:function(e,i){for(var c=n(e)&f,l=a[c],s=0;l!=o;){if(t(l,e))return u[c];if(++s>=r)throw new Error("full hashmap");l=a[c=c+1&f]}return a[c]=e,u[c]=i,i},get:function(e,i){for(var c=n(e)&f,l=a[c],s=0;l!=o;){if(t(l,e))return u[c];if(++s>=r)break;l=a[c=c+1&f]}return i},keys:function(){for(var r=[],n=0,t=a.length;n<t;++n){var e=a[n];e!=o&&r.push(e)}return r}}}function t(r,n){return r[0]===n[0]&&r[1]===n[1]}var e=new ArrayBuffer(16),o=new Float64Array(e),i=new Uint32Array(e);function a(r){o[0]=r[0],o[1]=r[1];var n=i[0]^i[1];return 2147483647&(n=n<<5^n>>7^i[2]^i[3])}function u(r){var e,o,i,u,f=r.coordinates,c=r.lines,l=r.rings,s=function(){for(var r=n(1.4*f.length,A,E,Int32Array,-1,Int32Array),t=new Int32Array(f.length),e=0,o=f.length;e<o;++e)t[e]=r.maybeSet(e,e);return t}(),h=new Int32Array(f.length),g=new Int32Array(f.length),v=new Int32Array(f.length),p=new Int8Array(f.length),y=0;for(e=0,o=f.length;e<o;++e)h[e]=g[e]=v[e]=-1;for(e=0,o=c.length;e<o;++e){var d=c[e],m=d[0],b=d[1];for(i=s[m],u=s[++m],++y,p[i]=1;++m<=b;)P(e,i,i=u,u=s[m]);++y,p[u]=1}for(e=0,o=f.length;e<o;++e)h[e]=-1;for(e=0,o=l.length;e<o;++e){var M=l[e],w=M[0]+1,x=M[1];for(P(e,s[x-1],i=s[w-1],u=s[w]);++w<=x;)P(e,i,i=u,u=s[w])}function P(r,n,t,e){if(h[t]!==r){h[t]=r;var o=g[t];if(o>=0){var i=v[t];o===n&&i===e||o===e&&i===n||(++y,p[t]=1)}else g[t]=n,v[t]=e}}function A(r){return a(f[r])}function E(r,n){return t(f[r],f[n])}h=g=v=null;var L,S=function(r,n,t,e,o){3===arguments.length&&(e=Array,o=null);for(var i=new e(r=1<<Math.max(4,Math.ceil(Math.log(r)/Math.LN2))),a=r-1,u=0;u<r;++u)i[u]=o;return{add:function(e){for(var u=n(e)&a,f=i[u],c=0;f!=o;){if(t(f,e))return!0;if(++c>=r)throw new Error("full hashset");f=i[u=u+1&a]}return i[u]=e,!0},has:function(e){for(var u=n(e)&a,f=i[u],c=0;f!=o;){if(t(f,e))return!0;if(++c>=r)break;f=i[u=u+1&a]}return!1},values:function(){for(var r=[],n=0,t=i.length;n<t;++n){var e=i[n];e!=o&&r.push(e)}return r}}}(1.4*y,a,t);for(e=0,o=f.length;e<o;++e)p[L=s[e]]&&S.add(f[L]);return S}function f(r,n,t,e){c(r,n,t),c(r,n,n+e),c(r,n+e,t)}function c(r,n,t){for(var e,o=n+(t---n>>1);n<o;++n,--t)e=r[n],r[n]=r[t],r[t]=e}function l(r){var n,t,e={};for(n in r)e[n]=null==(t=r[n])?{type:null}:("FeatureCollection"===t.type?s:"Feature"===t.type?h:g)(t);return e}function s(r){var n={type:"GeometryCollection",geometries:r.features.map(h)};return null!=r.bbox&&(n.bbox=r.bbox),n}function h(r){var n,t=g(r.geometry);for(n in null!=r.id&&(t.id=r.id),null!=r.bbox&&(t.bbox=r.bbox),r.properties){t.properties=r.properties;break}return t}function g(r){if(null==r)return{type:null};var n="GeometryCollection"===r.type?{type:"GeometryCollection",geometries:r.geometries.map(g)}:"Point"===r.type||"MultiPoint"===r.type?{type:r.type,coordinates:r.coordinates}:{type:r.type,arcs:r.coordinates};return null!=r.bbox&&(n.bbox=r.bbox),n}function v(e,o){var i=function(n){var t=1/0,e=1/0,o=-1/0,i=-1/0;function a(n){null!=n&&r.call(u,n.type)&&u[n.type](n)}var u={GeometryCollection:function(r){r.geometries.forEach(a)},Point:function(r){f(r.coordinates)},MultiPoint:function(r){r.coordinates.forEach(f)},LineString:function(r){c(r.arcs)},MultiLineString:function(r){r.arcs.forEach(c)},Polygon:function(r){r.arcs.forEach(c)},MultiPolygon:function(r){r.arcs.forEach(l)}};function f(r){var n=r[0],a=r[1];n<t&&(t=n),n>o&&(o=n),a<e&&(e=a),a>i&&(i=a)}function c(r){r.forEach(f)}function l(r){r.forEach(c)}for(var s in n)a(n[s]);return o>=t&&i>=e?[t,e,o,i]:void 0}(e=l(e)),c=o>0&&i&&function(n,t,e){var o=t[0],i=t[1],a=t[2],u=t[3],f=a-o?(e-1)/(a-o):1,c=u-i?(e-1)/(u-i):1;function l(r){return[Math.round((r[0]-o)*f),Math.round((r[1]-i)*c)]}function s(r,n){for(var t,e,a,u,l,s=-1,h=0,g=r.length,v=new Array(g);++s<g;)t=r[s],u=Math.round((t[0]-o)*f),l=Math.round((t[1]-i)*c),u===e&&l===a||(v[h++]=[e=u,a=l]);for(v.length=h;h<n;)h=v.push([v[0][0],v[0][1]]);return v}function h(r){return s(r,2)}function g(r){return s(r,4)}function v(r){return r.map(g)}function p(n){null!=n&&r.call(y,n.type)&&y[n.type](n)}var y={GeometryCollection:function(r){r.geometries.forEach(p)},Point:function(r){r.coordinates=l(r.coordinates)},MultiPoint:function(r){r.coordinates=r.coordinates.map(l)},LineString:function(r){r.arcs=h(r.arcs)},MultiLineString:function(r){r.arcs=r.arcs.map(h)},Polygon:function(r){r.arcs=v(r.arcs)},MultiPolygon:function(r){r.arcs=r.arcs.map(v)}};for(var d in n)p(n[d]);return{scale:[1/f,1/c],translate:[o,i]}}(e,i,o),s=function(r){var e,o,i,u,f=r.coordinates,c=r.lines,l=r.rings,s=c.length+l.length;for(delete r.lines,delete r.rings,i=0,u=c.length;i<u;++i)for(e=c[i];e=e.next;)++s;for(i=0,u=l.length;i<u;++i)for(o=l[i];o=o.next;)++s;var h=n(2*s*1.4,a,t),g=r.arcs=[];for(i=0,u=c.length;i<u;++i){e=c[i];do{v(e)}while(e=e.next)}for(i=0,u=l.length;i<u;++i)if((o=l[i]).next)do{v(o)}while(o=o.next);else p(o);function v(r){var n,t,e,o,i,a,u,c;if(e=h.get(n=f[r[0]]))for(u=0,c=e.length;u<c;++u)if(y(o=e[u],r))return r[0]=o[0],void(r[1]=o[1]);if(i=h.get(t=f[r[1]]))for(u=0,c=i.length;u<c;++u)if(d(a=i[u],r))return r[1]=a[0],void(r[0]=a[1]);e?e.push(r):h.set(n,[r]),i?i.push(r):h.set(t,[r]),g.push(r)}function p(r){var n,t,e,o,i;if(t=h.get(f[r[0]]))for(o=0,i=t.length;o<i;++o){if(m(e=t[o],r))return r[0]=e[0],void(r[1]=e[1]);if(b(e,r))return r[0]=e[1],void(r[1]=e[0])}if(t=h.get(n=f[r[0]+M(r)]))for(o=0,i=t.length;o<i;++o){if(m(e=t[o],r))return r[0]=e[0],void(r[1]=e[1]);if(b(e,r))return r[0]=e[1],void(r[1]=e[0])}t?t.push(r):h.set(n,[r]),g.push(r)}function y(r,n){var e=r[0],o=n[0],i=r[1];if(e-i!=o-n[1])return!1;for(;e<=i;++e,++o)if(!t(f[e],f[o]))return!1;return!0}function d(r,n){var e=r[0],o=n[0],i=r[1],a=n[1];if(e-i!=o-a)return!1;for(;e<=i;++e,--a)if(!t(f[e],f[a]))return!1;return!0}function m(r,n){var e=r[0],o=n[0],i=r[1]-e;if(i!==n[1]-o)return!1;for(var a=M(r),u=M(n),c=0;c<i;++c)if(!t(f[e+(c+a)%i],f[o+(c+u)%i]))return!1;return!0}function b(r,n){var e=r[0],o=n[0],i=r[1],a=n[1],u=i-e;if(u!==a-o)return!1;for(var c=M(r),l=u-M(n),s=0;s<u;++s)if(!t(f[e+(s+c)%u],f[a-(s+l)%u]))return!1;return!0}function M(r){for(var n=r[0],t=r[1],e=n,o=e,i=f[e];++e<t;){var a=f[e];(a[0]<i[0]||a[0]===i[0]&&a[1]<i[1])&&(o=e,i=a)}return o-n}return r}(function(r){var n,t,e,o=u(r),i=r.coordinates,a=r.lines,c=r.rings;for(t=0,e=a.length;t<e;++t)for(var l=a[t],s=l[0],h=l[1];++s<h;)o.has(i[s])&&(n={0:s,1:l[1]},l[1]=s,l=l.next=n);for(t=0,e=c.length;t<e;++t)for(var g=c[t],v=g[0],p=v,y=g[1],d=o.has(i[v]);++p<y;)o.has(i[p])&&(d?(n={0:p,1:g[1]},g[1]=p,g=g.next=n):(f(i,v,y,y-p),i[y]=i[v],d=!0,p=v));return r}(function(n){var t=-1,e=[],o=[],i=[];function a(n){n&&r.call(u,n.type)&&u[n.type](n)}var u={GeometryCollection:function(r){r.geometries.forEach(a)},LineString:function(r){r.arcs=f(r.arcs)},MultiLineString:function(r){r.arcs=r.arcs.map(f)},Polygon:function(r){r.arcs=r.arcs.map(c)},MultiPolygon:function(r){r.arcs=r.arcs.map(l)}};function f(r){for(var n=0,o=r.length;n<o;++n)i[++t]=r[n];var a={0:t-o+1,1:t};return e.push(a),a}function c(r){for(var n=0,e=r.length;n<e;++n)i[++t]=r[n];var a={0:t-e+1,1:t};return o.push(a),a}function l(r){return r.map(c)}for(var s in n)a(n[s]);return{type:"Topology",coordinates:i,lines:e,rings:o,objects:n}}(e))),h=s.coordinates,g=n(1.4*s.arcs.length,p,y);function v(n){n&&r.call(d,n.type)&&d[n.type](n)}e=s.objects,s.bbox=i,s.arcs=s.arcs.map((function(r,n){return g.set(r,n),h.slice(r[0],r[1]+1)})),delete s.coordinates,h=null;var d={GeometryCollection:function(r){r.geometries.forEach(v)},LineString:function(r){r.arcs=m(r.arcs)},MultiLineString:function(r){r.arcs=r.arcs.map(m)},Polygon:function(r){r.arcs=r.arcs.map(m)},MultiPolygon:function(r){r.arcs=r.arcs.map(b)}};function m(r){var n=[];do{var t=g.get(r);n.push(r[0]<r[1]?t:~t)}while(r=r.next);return n}function b(r){return r.map(m)}for(var M in e)v(e[M]);return c&&(s.transform=c,s.arcs=function(r){for(var n=-1,t=r.length;++n<t;){for(var e,o,i=r[n],a=0,u=1,f=i.length,c=i[0],l=c[0],s=c[1];++a<f;)e=(c=i[a])[0],o=c[1],e===l&&o===s||(i[u++]=[e-l,o-s],l=e,s=o);1===u&&(i[u++]=[0,0]),i.length=u}return r}(s.arcs)),s}function p(r){var n,t=r[0],e=r[1];return e<t&&(n=t,t=e,e=n),t+31*e}function y(r,n){var t,e=r[0],o=r[1],i=n[0],a=n[1];return o<e&&(t=e,e=o,o=t),a<i&&(t=i,i=a,a=t),e===i&&o===a}export{v as topology};export default null;
