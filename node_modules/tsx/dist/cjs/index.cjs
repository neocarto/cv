"use strict";var f=require("path"),S=require("fs"),a=require("module"),l=require("get-tsconfig"),g=require("../source-map.cjs"),m=require("../index-129c7da4.cjs"),j=require("../resolve-ts-path-3fca13b7.cjs");require("source-map-support"),require("../node-features-a3d031eb.cjs"),require("url"),require("esbuild"),require("crypto"),require("os");const E=s=>{if(s.includes("import")||s.includes("export")){const[e,n]=m.parseEsm(s);return e.length>0||n.length>0}return!1},O=/^\.{1,2}\//,q=/\.[cm]?tsx?$/,M=`${f.sep}node_modules${f.sep}`,u=process.env.TSX_TSCONFIG_PATH?{path:f.resolve(process.env.TSX_TSCONFIG_PATH),config:l.parseTsconfig(process.env.TSX_TSCONFIG_PATH)}:l.getTsconfig(),_=u&&l.createFilesMatcher(u),h=u&&l.createPathsMatcher(u),x=g.installSourceMapSupport(),d=a._extensions,P=d[".js"],A=[".cts",".mts",".ts",".tsx",".jsx"],N=[".js",".cjs",".mjs"],F=(s,e)=>{process.send&&process.send({type:"dependency",path:e});const n=A.some(r=>e.endsWith(r)),o=N.some(r=>e.endsWith(r));if(!n&&!o)return P(s,e);let t=S.readFileSync(e,"utf8");if(e.endsWith(".cjs")){const r=m.transformDynamicImport(e,t);r&&(t=x(r,e))}else if(n||E(t)){const r=m.transformSync(t,e,{tsconfigRaw:_==null?void 0:_(e)});t=x(r,e)}s._compile(t,e)};[".js",".ts",".tsx",".jsx"].forEach(s=>{d[s]=F}),Object.defineProperty(d,".mjs",{value:F,enumerable:!1});const v=a._resolveFilename.bind(a);a._resolveFilename=(s,e,n,o)=>{var t;const r=s.indexOf("?");if(r!==-1&&(s=s.slice(0,r)),h&&!O.test(s)&&!((t=e==null?void 0:e.filename)!=null&&t.includes(M))){const i=h(s);for(const T of i){const p=y(T,e,n,o);if(p)return p;try{return v(T,e,n,o)}catch{}}}const c=y(s,e,n,o);return c||v(s,e,n,o)};const y=(s,e,n,o)=>{const t=j.resolveTsPath(s);if(e!=null&&e.filename&&q.test(e.filename)&&t)for(const r of t)try{return v(r,e,n,o)}catch(c){const{code:i}=c;if(i!=="MODULE_NOT_FOUND"&&i!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw c}};
